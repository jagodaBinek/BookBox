import{$a as A,Ea as F,Fa as E,Ga as g,Ha as o,Ia as n,Ja as b,Ka as C,L as P,La as p,Ma as u,Na as T,O,Oa as s,Pa as N,Qa as z,U as v,V as _,W as w,X as k,ab as j,ba as m,c as d,ib as $,j as I,kb as Y,la as U,lb as f,ma as c,mb as V,nb as B,ob as M,qb as R,rb as x,ta as S,xa as D,za as y}from"./chunk-DRQDUYK3.js";var h=class r{constructor(e){this.firestore=e;this.loadImagesFromFirestore()}cloudName=x.cloudinary.cloudName;uploadPreset=x.cloudinary.uploadPreset;uploadedImages$=new I([]);imagesCollectionName="cloudinary_uploads";getUploadedImages(){return this.uploadedImages$.asObservable()}loadImagesFromFirestore(){return d(this,null,function*(){try{let e=f(this.firestore,this.imagesCollectionName),t=yield M(e),a=[];t.forEach(i=>{a.push({id:i.id,url:i.data().url,uploadedAt:i.data().uploadedAt})}),a.sort((i,l)=>l.uploadedAt-i.uploadedAt),this.uploadedImages$.next(a)}catch(e){console.error("Error loading images from Firestore:",e)}})}uploadImage(e){return d(this,null,function*(){let t=new FormData;t.append("file",e),t.append("upload_preset",this.uploadPreset);try{let a=yield fetch(`https://api.cloudinary.com/v1_1/${this.cloudName}/image/upload`,{method:"POST",body:t});if(!a.ok)throw new Error(`Upload failed: ${a.statusText}`);let l=(yield a.json()).secure_url;return yield this.saveImageToFirestore(l),l}catch(a){throw console.error("Error uploading image:",a),a}})}saveImageToFirestore(e){return d(this,null,function*(){try{let t=f(this.firestore,this.imagesCollectionName);yield Y(t,{url:e,uploadedAt:Date.now()}),yield this.loadImagesFromFirestore()}catch(t){throw console.error("Error saving image to Firestore:",t),t}})}deleteImage(e){return d(this,null,function*(){try{let t=B(this.firestore,this.imagesCollectionName,e);yield V(t),yield this.loadImagesFromFirestore()}catch(t){throw console.error("Error deleting image from Firestore:",t),t}})}clearAllImages(){return d(this,null,function*(){try{let e=f(this.firestore,this.imagesCollectionName),t=yield M(e),a=R(this.firestore);t.forEach(i=>{a.delete(i.ref)}),yield a.commit(),this.uploadedImages$.next([])}catch(e){throw console.error("Error clearing images from Firestore:",e),e}})}static \u0275fac=function(t){return new(t||r)(O($))};static \u0275prov=P({token:r,factory:r.\u0275fac,providedIn:"root"})};var G=(r,e)=>e.id;function W(r,e){if(r&1&&(o(0,"div",15)(1,"p",16),s(2),n()()),r&2){let t=u();c(2),N(t.uploadMessage())}}function J(r,e){if(r&1){let t=C();o(0,"div",21),b(1,"img",22),o(2,"button",23),p("click",function(){let i=v(t).$implicit,l=u(2);return _(l.deleteImage(i.id))}),s(3," \u2715 "),n()()}if(r&2){let t=e.$implicit;c(),g("src",t.url,U)("alt","Uploaded image")}}function K(r,e){if(r&1){let t=C();o(0,"div",17)(1,"div",18)(2,"h2"),s(3),n(),o(4,"button",19),p("click",function(){v(t);let i=u();return _(i.clearAll())}),s(5," Clear All "),n()(),o(6,"div",20),F(7,J,4,2,"div",21,G),n()()}if(r&2){let t=u();c(3),z("Uploaded Images (",t.uploadedImages().length,")"),c(4),E(t.uploadedImages())}}function Q(r,e){r&1&&(o(0,"div",24)(1,"p"),s(2,"No images uploaded yet. Start by uploading an image above."),n()())}var L=class r{constructor(e){this.cloudinaryService=e;this.cloudinaryService.getUploadedImages().subscribe(t=>{this.uploadedImages.set(t)})}uploadedImages=m([]);isUploading=m(!1);uploadMessage=m("");isDragOver=m(!1);onFileSelected(e){let t=e.target;t.files&&t.files.length>0&&this.uploadFile(t.files[0])}onDragOver(e){e.preventDefault(),e.stopPropagation(),this.isDragOver.set(!0)}onDragLeave(e){e.preventDefault(),e.stopPropagation(),this.isDragOver.set(!1)}onDrop(e){e.preventDefault(),e.stopPropagation(),this.isDragOver.set(!1),e.dataTransfer&&e.dataTransfer.files.length>0&&this.uploadFile(e.dataTransfer.files[0])}uploadFile(e){return d(this,null,function*(){if(!e.type.startsWith("image/")){this.uploadMessage.set("\u274C Please select an image file"),setTimeout(()=>this.uploadMessage.set(""),3e3);return}let t=5*1024*1024;if(e.size>t){this.uploadMessage.set("\u274C File size must be less than 5MB"),setTimeout(()=>this.uploadMessage.set(""),3e3);return}this.isUploading.set(!0),this.uploadMessage.set("\u23F3 Uploading...");try{yield this.cloudinaryService.uploadImage(e),this.uploadMessage.set("\u2705 Image uploaded successfully!"),setTimeout(()=>this.uploadMessage.set(""),3e3)}catch(a){console.error("Upload error:",a),this.uploadMessage.set("\u274C Upload failed. Please try again."),setTimeout(()=>this.uploadMessage.set(""),3e3)}finally{this.isUploading.set(!1)}})}clearAll(){return d(this,null,function*(){try{yield this.cloudinaryService.clearAllImages(),this.uploadMessage.set("\u2705 All images cleared"),setTimeout(()=>this.uploadMessage.set(""),3e3)}catch(e){console.error("Error clearing images:",e),this.uploadMessage.set("\u274C Failed to clear images"),setTimeout(()=>this.uploadMessage.set(""),3e3)}})}deleteImage(e){return d(this,null,function*(){if(e)try{yield this.cloudinaryService.deleteImage(e),this.uploadMessage.set("\u2705 Image deleted"),setTimeout(()=>this.uploadMessage.set(""),3e3)}catch(t){console.error("Error deleting image:",t),this.uploadMessage.set("\u274C Failed to delete image"),setTimeout(()=>this.uploadMessage.set(""),3e3)}})}static \u0275fac=function(t){return new(t||r)(S(h))};static \u0275cmp=D({type:r,selectors:[["app-image-upload"]],decls:26,vars:6,consts:[[1,"container"],[1,"header"],[1,"upload-section"],[1,"upload-area",3,"dragover","dragleave","drop"],[1,"upload-content"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"upload-icon"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","17 8 12 3 7 8"],["x1","12","y1","3","x2","12","y2","15"],[1,"file-input-label"],["type","file","accept","image/*",1,"file-input",3,"change","disabled"],[1,"file-info"],["class","message-area",4,"ngIf"],["class","gallery-section",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"message-area"],[1,"upload-message"],[1,"gallery-section"],[1,"gallery-header"],["type","button",1,"clear-button",3,"click"],[1,"image-gallery"],[1,"image-card"],[1,"gallery-image",3,"src","alt"],["type","button","title","Delete image",1,"delete-button",3,"click"],[1,"empty-state"]],template:function(t,a){t&1&&(o(0,"div",0)(1,"div",1)(2,"h1"),s(3,"Image Upload Test"),n(),o(4,"p"),s(5,"Upload images to Cloudinary and view them below"),n()(),o(6,"div",2)(7,"div",3),p("dragover",function(l){return a.onDragOver(l)})("dragleave",function(l){return a.onDragLeave(l)})("drop",function(l){return a.onDrop(l)}),o(8,"div",4),w(),o(9,"svg",5),b(10,"path",6)(11,"polyline",7)(12,"line",8),n(),k(),o(13,"h3"),s(14,"Drag and drop images here"),n(),o(15,"p"),s(16,"or"),n(),o(17,"label",9)(18,"span"),s(19,"Click to browse"),n(),o(20,"input",10),p("change",function(l){return a.onFileSelected(l)}),n()(),o(21,"p",11),s(22,"Maximum file size: 5MB"),n()()(),y(23,W,3,1,"div",12),n(),y(24,K,9,1,"div",13)(25,Q,3,0,"div",14),n()),t&2&&(c(7),T("drag-over",a.isDragOver()),c(13),g("disabled",a.isUploading()),c(3),g("ngIf",a.uploadMessage()),c(),g("ngIf",a.uploadedImages().length>0),c(),g("ngIf",a.uploadedImages().length===0))},dependencies:[j,A],styles:["[_nghost-%COMP%]{display:block;--bright-blue: oklch(51.01% .274 263.83);--electric-violet: oklch(53.18% .28 296.97);--vivid-pink: oklch(69.02% .277 332.77);--orange-red: oklch(63.32% .24 31.68);--gray-900: oklch(19.37% .006 300.98);--gray-700: oklch(36.98% .014 302.71);--gray-400: oklch(70.9% .015 304.04);--gray-200: oklch(89.2% .01 304);--success-green: oklch(68% .16 142);--error-red: oklch(54% .21 25);--gradient: linear-gradient( 135deg, var(--orange-red) 0%, var(--vivid-pink) 50%, var(--electric-violet) 100% )}.container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;color:var(--gray-900);font-weight:600;margin:0 0 .5rem}.header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--gray-700);margin:0}.upload-section[_ngcontent-%COMP%]{margin-bottom:2rem}.upload-area[_ngcontent-%COMP%]{border:2px dashed var(--bright-blue);border-radius:1rem;padding:3rem 2rem;text-align:center;background-color:color-mix(in srgb,var(--bright-blue) 5%,transparent);transition:all .3s ease;cursor:pointer}.upload-area[_ngcontent-%COMP%]:hover{background-color:color-mix(in srgb,var(--bright-blue) 10%,transparent);border-color:var(--electric-violet)}.upload-area.drag-over[_ngcontent-%COMP%]{background:var(--gradient);background-clip:padding-box;border-color:transparent;box-shadow:inset 0 0 0 2px var(--gradient),0 0 20px #ff41f833;transform:scale(1.02)}.upload-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.upload-icon[_ngcontent-%COMP%]{width:48px;height:48px;color:var(--bright-blue);animation:_ngcontent-%COMP%_float 3s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.upload-area[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--gray-900);margin:0;font-weight:600}.upload-area[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--gray-700);margin:0;font-size:.95rem}.file-input-label[_ngcontent-%COMP%]{display:inline-block;padding:.75rem 1.5rem;background:var(--gradient);color:#fff;border-radius:.5rem;font-weight:600;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease}.file-input-label[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #ff41f84d}.file-input-label[_ngcontent-%COMP%]:active{transform:translateY(0)}.file-input[_ngcontent-%COMP%]{display:none}.file-info[_ngcontent-%COMP%]{font-size:.85rem;color:var(--gray-700);margin-top:.5rem}.message-area[_ngcontent-%COMP%]{margin-top:1rem;text-align:center}.upload-message[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border-radius:.5rem;font-weight:500;margin:0;background-color:color-mix(in srgb,var(--gray-200) 1,transparent);color:var(--gray-900);animation:_ngcontent-%COMP%_slideIn .3s ease}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.gallery-section[_ngcontent-%COMP%]{margin-top:3rem}.gallery-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.gallery-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.75rem;color:var(--gray-900);margin:0;font-weight:600}.clear-button[_ngcontent-%COMP%]{padding:.6rem 1.2rem;background-color:var(--error-red);color:#fff;border:none;border-radius:.5rem;font-weight:600;cursor:pointer;transition:all .2s ease}.clear-button[_ngcontent-%COMP%]:hover{background-color:color-mix(in srgb,var(--error-red) 110%,var(--gray-900));transform:translateY(-2px);box-shadow:0 4px 12px #ff41f833}.image-gallery[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1.5rem}.image-card[_ngcontent-%COMP%]{position:relative;border-radius:.75rem;overflow:hidden;box-shadow:0 4px 12px #0000001a;transition:all .3s ease;background:#fff}.image-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 12px 24px #ff41f833}.gallery-image[_ngcontent-%COMP%]{width:100%;height:200px;object-fit:cover;display:block}.delete-button[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;width:2rem;height:2rem;border-radius:50%;background-color:#ff41f8e6;color:#fff;border:none;font-size:1.2rem;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:0;transition:all .2s ease}.image-card[_ngcontent-%COMP%]:hover   .delete-button[_ngcontent-%COMP%]{opacity:1}.delete-button[_ngcontent-%COMP%]:hover{background-color:var(--error-red);transform:scale(1.1)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem;color:var(--gray-700);font-size:1.1rem;border:2px dashed var(--gray-400);border-radius:1rem;background-color:color-mix(in srgb,var(--gray-200) 5%,transparent)}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.image-gallery[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1rem}.gallery-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:flex-start}.clear-button[_ngcontent-%COMP%]{width:100%}}"]})};export{L as ImageUploadComponent};
